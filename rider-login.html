<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Big Red Rider ‚Äî Sign In</title>

  <!-- PWA / Icons -->
  <link rel="apple-touch-icon" href="/icon.PNG">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon.png">
  <link rel="shortcut icon" href="/icon.PNG">
  <link rel="manifest" href="manifest-rider.json">
  <meta name="apple-mobile-web-app-title" content="Big Red Rider">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="theme-color" content="#000000">

  <style>
    :root {
      --red:#b30000;
      --bg:#000;
      --panel:#111;
      --muted:#aaa;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      background:var(--bg);
      color:#fff;
      font-family:Arial,Helvetica,sans-serif;
    }
    header{
      width:100%;
      padding:10px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:#050505;
      border-bottom:2px solid var(--red);
    }
    .logo{display:flex;align-items:center;gap:10px;}
    .logo img{height:40px;border-radius:4px;}
    .logo span{font-weight:700;font-size:1rem;}
    .home-link a{
      color:#fff;
      text-decoration:none;
      font-size:.9rem;
      border:1px solid var(--red);
      padding:6px 10px;
      border-radius:6px;
    }
    main{
      flex:1;
      width:100%;
      max-width:480px;
      padding:16px;
    }
    h1{
      margin:16px 0 4px;
      font-size:1.5rem;
      color:var(--red);
      text-align:center;
    }
    .tagline{
      text-align:center;
      color:#ddd;
      font-size:.95rem;
      margin-bottom:12px;
    }
    .card{
      background:var(--panel);
      border-radius:10px;
      border:1px solid #222;
      padding:14px 12px 16px;
      margin-bottom:14px;
    }
    label{
      display:block;
      font-size:.85rem;
      margin:6px 0 2px;
      color:#ccc;
    }
    input{
      width:100%;
      padding:8px 10px;
      border-radius:6px;
      border:1px solid #333;
      background:#000;
      color:#fff;
      font-size:.95rem;
    }
    button{
      margin-top:12px;
      width:100%;
      padding:10px 12px;
      border-radius:6px;
      border:none;
      cursor:pointer;
      font-weight:600;
      font-size:.95rem;
      background:var(--red);
      color:#fff;
    }
    .hint{
      font-size:.8rem;
      color:var(--muted);
      margin-top:6px;
    }
    footer{
      width:100%;
      text-align:center;
      padding:12px 8px 16px;
      font-size:.85rem;
      color:#777;
    }
    #toast{
      position:fixed;
      bottom:20px;
      left:50%;
      transform:translateX(-50%);
      background:var(--red);
      color:#fff;
      padding:8px 14px;
      border-radius:6px;
      opacity:0;
      transition:opacity .3s;
      z-index:10;
      font-size:.9rem;
    }
  </style>
</head>
<body>

<header>
  <div class="logo">
    <img src="/icon.PNG" alt="Big Red Connect Logo">
    <span>Big Red Rider</span>
  </div>
  <div class="home-link">
    <a href="/index.html">üè† Main Site</a>
  </div>
</header>

<main>
  <h1>Sign In to Rider Hub</h1>
  <p class="tagline">
    Use your mobile number to access your Rider Hub, request flat-rate rides, and view past trips.
  </p>

  <section class="card">
    <form id="loginForm">
      <label for="phone">Mobile Number</label>
      <input id="phone" type="tel" autocomplete="tel"
             placeholder="Ex: 405-555-1234" />

      <div class="hint">
        No password needed. Your mobile number becomes your rider ID.
      </div>

      <button type="submit">üöÄ Continue to Rider Hub</button>
    </form>
  </section>
</main>

<footer>
  ¬© 2025 Big Red Connect ‚Äî Local. Affordable Flat Rates. Trusted.
</footer>

<div id="toast"></div>

<script>
  const RIDER_ID_KEY = "bigred_rider_id";

  function showToast(msg, ms = 2200) {
    const toast = document.getElementById("toast");
    toast.textContent = msg;
    toast.style.opacity = 1;
    setTimeout(() => toast.style.opacity = 0, ms);
  }

  function normalizePhone(raw) {
    if (!raw) return "";
    const digits = raw.replace(/\D/g, "");
    if (digits.length === 10) {
      return "+1" + digits;
    }
    if (digits.length === 11 && digits.startsWith("1")) {
      return "+" + digits;
    }
    if (digits.startsWith("+1") && digits.length === 12) {
      return digits;
    }
    return "";
  }

  document.getElementById("loginForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const raw = document.getElementById("phone").value.trim();
    const normalized = normalizePhone(raw);

    if (!normalized) {
      showToast("Please enter a valid US mobile number.");
      return;
    }

    localStorage.setItem(RIDER_ID_KEY, normalized);
    window.location.href = "/rider/rider.html";
  });

  // If already logged in, skip straight to Rider Hub
  document.addEventListener("DOMContentLoaded", () => {
    const existing = localStorage.getItem(RIDER_ID_KEY);
    if (existing) {
      window.location.href = "/rider/rider.html";
    }
  });
</script>

</body>
</html>