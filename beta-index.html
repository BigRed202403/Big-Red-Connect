<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Big Red Connect</title>

  <!-- üì± PWA / Icons -->
  <link rel="apple-touch-icon" href="icon.PNG">
  <link rel="icon" type="image/png" sizes="192x192" href="icon.png">
  <link rel="shortcut icon" href="icon.PNG">
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-title" content="Big Red Connect">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="theme-color" content="#000000">

  <!-- üö´ No cache -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- üé® Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- üåÜ Hero -->
  <div class="hero"></div>

  <!-- üöó Logo -->
  <img src="official_logo_Nov.png" alt="Big Red Connect Logo" class="main-logo" />

  <!-- üè∑Ô∏è Tagline -->
  <p class="tagline">Veteran Owned ¬∑ Affordable Flat Rates ¬∑ Trusted Local Connections</p>

  <!-- üö¶ Dynamic Status Pill -->
  <div id="status-pill" class="status status--loading">Checking status‚Ä¶</div>

  <!-- üîÑ Floating Refresh Button -->
  <button id="refreshButton" title="Refresh Page">üîÑ Refresh</button>

  <!-- üì≤ Quick Actions -->
  <div class="cta-group">
    <a href="sms:14053784024" class="btn primary">üì≤ Text ‚ÄúRED‚Äù</a>
    <a href="tel:14053784024" class="btn secondary">üìû Call Big Red</a>
  </div>

  <!-- üîî PUSH NOTIFICATION CTA (added here) -->
  <div style="text-align:center; margin:25px 0 10px;">
    <button id="brcNotifyBtn" style="
      background:#b30000;
      color:#fff;
      padding:12px 20px;
      border:none;
      border-radius:8px;
      font-size:1.1rem;
      cursor:pointer;
    ">
      üîî Enable Big Red Notifications
    </button>
    <p style="color:#888; font-size:0.8em; margin-top:8px;">
      Get alerts when Big Red goes live or posts updates.
    </p>
  </div>

  <!-- üß≠ ‚ÄúWhere To?‚Äù -->
  <div class="info-section" style="text-align:center; margin-top:20px;">
    <h2 style="margin-bottom:10px;">Where To?</h2>
    <form id="quickDestination" onsubmit="goToFare(event)" style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
      <input id="quickWhere" type="text" placeholder="Plan Your Connection" required 
             style="flex:1;min-width:220px;max-width:420px;padding:12px;border-radius:10px;border:1px solid #333;background:#111;color:#fff;">
      <button type="submit" class="btn primary">‚û°Ô∏è Next</button>
    </form>
    <p style="font-size:0.9em;color:#888;margin-top:6px;">
      Tip: Start typing a place, business, or address ‚Äî suggestions will appear.
    </p>
  </div>

  <!-- üß± Navigation Tiles -->
  <div class="tile-grid">
    <a href="farecalculator.html" class="tile">üí≤<br>Fare Calculator</a>
    <a href="live.html" class="tile">üó∫Ô∏è<br>Live Map</a>
    <a href="reviews.html" class="tile">‚≠ê<br>Rider Reviews</a>
    <a href="faq.html" class="tile">‚ÑπÔ∏è<br>FAQ & Info</a>
    <a href="https://www.facebook.com/share/1BWCx63CUt/?mibextid=wwXIfr" target="_blank" class="tile">üëç<br>Follow on Facebook</a>
  </div>

  <!-- üßæ What I Do -->
  <section class="info-section">
    <h2>What I Do</h2>
    <p>
      I offer local ride connections across the Oklahoma City metro ‚Äî from workdays and class runs
      to weekend nights, OU games, and airport trips.
    </p>
    <ul>
      <li>Daily work, school, and appointment connections</li>
      <li>Airport and Tinker AFB flat-rate rides</li>
      <li>Evening and nightlife link-ups</li>
      <li>Event, casino, and concert trips ‚Äî plan ahead and ride local</li>
    </ul>
  </section>

  <!-- ‚ù§Ô∏è Why Choose Red -->
  <section class="info-section">
    <h2>Why Choose Red</h2>
    <ul>
      <li>Veteran-owned and operated ‚Äî every connection is personal.</li>
      <li>Flat-rate, fair pricing with zero surprises.</li>
      <li>One trusted driver ‚Äî no random apps or surge pricing.</li>
    </ul>
  </section>

  <!-- üí¨ Reviews -->
  <section class="info-section">
    <h2>What Riders Say</h2>
    <div class="review-card">
      ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‚ÄúAlways dependable and easy to reach. Flat rate, no surprises.‚Äù<br>
      ‚Äî <strong>Alex, Norman</strong>
    </div>
    <div class="review-card">
      ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‚ÄúFeels like riding with a friend, not an app. My go-to for nights out.‚Äù<br>
      ‚Äî <strong>Taylor, OKC</strong>
    </div>
    <p><a href="reviews.html">See more reviews ‚Üí</a></p>
  </section>

  <!-- ü¶∂ Footer -->
  <footer>
    <p>Questions or ride connection requests?<br>Text <strong>‚ÄúRED‚Äù</strong> to (405) 378-4024.</p>
    <p><a href="faq.html">FAQ & Policies</a> | <a href="reviews.html">Leave a Review</a></p>
    <p>&copy; 2025 Big Red Connect</p>
    <p style="font-size:0.8em;color:#777;margin-top:10px;line-height:1.4;">
      Vehicle imagery features actual Big Red Connect fleet vehicles.<br>
      Some backgrounds created with AI-assisted design tools for illustrative purposes only.<br>
      Brand names (Chevrolet¬Æ and GMC¬Æ) are property of their respective owners and used descriptively.
    </p>
  </footer>

  <!-- üó∫Ô∏è Google Places -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCMM0dxLNM7XQI5G3OBSnINeO5hcS3Ks5I&libraries=places"></script>
  <script>
    let whereAuto;
    function initQuickSearch() {
      whereAuto = new google.maps.places.Autocomplete(
        document.getElementById("quickWhere"),
        { fields: ["formatted_address", "name"] }
      );
    }
    function goToFare(e) {
      e.preventDefault();
      const dest = document.getElementById("quickWhere").value.trim();
      if (dest) {
        window.location.href = "farecalculator.html?dropoff=" + encodeURIComponent(dest);
      }
    }
    window.onload = initQuickSearch;
  </script>

  <!-- üö¶ Global Status Pill -->
  <script src="status.js?v=20251026"></script>

  <!-- üîÑ Smart Refresh Button Logic -->
  <script>
    const refreshBtn = document.getElementById("refreshButton");
    let refreshTimeout;

    function showRefreshButton() {
      refreshBtn.classList.add("visible");
    }

    function hideRefreshButton() {
      refreshBtn.classList.remove("visible");
      clearTimeout(refreshTimeout);
      refreshTimeout = setTimeout(showRefreshButton, 30000);
    }

    refreshBtn.addEventListener("click", () => {
      hideRefreshButton();
      location.reload(true);
    });

    window.addEventListener("load", () => {
      refreshTimeout = setTimeout(showRefreshButton, 30000);
    });
  </script>

  <!-- üîî PUSH NOTIFICATION SYSTEM -->
  <script>
    const VAPID_PUBLIC_KEY = "YOUR_VAPID_PUBLIC_KEY_HERE";

    async function urlBase64ToUint8Array(base64String) {
      const padding = '='.repeat((4 - base64String.length % 4) % 4);
      const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');
      const raw = atob(base64);
      return Uint8Array.from([...raw].map(char => char.charCodeAt(0)));
    }

    async function subscribeForNotifications() {
      if (!("serviceWorker" in navigator)) {
        alert("Notifications not supported on this device.");
        return;
      }

      const registration = await navigator.serviceWorker.register("/service-worker.js");

      const subscription = await registration.pushManager.subscribe({
        userVisibleOnly: true,
        applicationServerKey: await urlBase64ToUint8Array(VAPID_PUBLIC_KEY)
      });

      await fetch("https://YOUR_WORKER_URL_HERE/saveSubscription", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(subscription)
      });

      alert("Notifications enabled! You'll get alerts when Big Red is live.");
    }

    document.getElementById("brcNotifyBtn")
      .addEventListener("click", subscribeForNotifications);
  </script>

  <!-- STYLE: Floating refresh -->
  <style>
    #refreshButton {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #b30000;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-size: 0.95em;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      z-index: 10;
    }
    #refreshButton.visible {
      opacity: 1;
      pointer-events: auto;
    }
    #refreshButton:hover { background: #cc0000; }
  </style>

</body>
</html>