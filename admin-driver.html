<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Big Red Admin / Driver Console</title>

  <link rel="apple-touch-icon" href="BRCNYE2026.png">
  <link rel="icon" type="image/png" sizes="192x192" href="BRCNYE2026.png">
  <link rel="shortcut icon" href="BRCNYE2026.png">
  <link rel="manifest" href="manifest-admin.json">
  <meta name="apple-mobile-web-app-title" content="Big Red Admin">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="theme-color" content="#000">
  <meta http-equiv="Cache-Control" content="no-store"/>

  <!-- OneSignal v16 -->
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script>
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    OneSignalDeferred.push(async function(OneSignal){
      try{
        await OneSignal.init({
          appId:"9b8bcc89-87d3-46e2-b2d0-042d1a267718",
          safari_web_id:"web.onesignal.auto.0c90051e-4735-447d-b203-75e3767d91b9",
          notifyButton:{ enable:false },
          serviceWorkerPath:"/onesignalsdkworker.js",
          path:"/"
        });
        await OneSignal.login("admin_driver_live");
        await OneSignal.sendTag("env","live");
        await OneSignal.sendTag("role_admin_live","true");
        await OneSignal.sendTag("role_driver_live","true");
        console.log("[Admin/Driver] OneSignal initialized + tags set.");
      }catch(e){
        console.warn("OneSignal admin-driver init error:",e);
      }
    });

    function enableAdminAlerts(){
      window.OneSignalDeferred.push(async function(OneSignal){
        const supported = OneSignal.Notifications.isPushSupported();
        if(!supported){
          alert("Notifications not supported on this device.");
          return;
        }
        const perm = OneSignal.Notifications.permission;
        if(perm === "granted" || perm === true){
          alert("Alerts already enabled.");
          return;
        }
        await OneSignal.Slidedown.promptPush();
      });
    }
  </script>

  <style>
    /* ===== OLD STYLE (RESTORED) ===== */
    :root{--red:#b30000;--bg:#000;--panel:#111;--muted:#aaa;--border:#222;--accent:#ffcc00;}
    *{box-sizing:border-box;}
    body{background:var(--bg);color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;margin:0;}
    header{background:var(--panel);display:flex;justify-content:space-between;align-items:center;padding:8px 12px;border-bottom:2px solid var(--red);position:sticky;top:0;z-index:20;}
    .header-left{display:flex;align-items:center;gap:10px;font-size:.9rem;min-width:0;}
    .header-left img{height:40px;border-radius:4px;}
    .pill{padding:3px 10px;border-radius:999px;font-weight:700;font-size:.8rem;white-space:nowrap;}
    .pill.online{background:#064;}
    .pill.away{background:#665500;}
    .pill.offline{background:#400;}
    .header-right{display:flex;gap:6px;align-items:center;}
    .btn{padding:6px 10px;border-radius:8px;border:none;cursor:pointer;font-weight:600;font-size:.85rem;}
    .btn-primary{background:var(--red);color:#fff;}
    .btn-secondary{background:#000;color:#fff;border:1px solid var(--red);}
    .btn-ghost{background:#111;color:#fff;border:1px solid #444;}
    h1{text-align:center;margin:14px 0 4px;color:var(--red);font-size:1.4rem;}
    .tagline{text-align:center;color:#ddd;margin:0 0 10px;font-size:.9rem;}
    #status-pill{margin:10px auto 12px;padding:8px 14px;border-radius:18px;display:inline-block;min-width:260px;font-size:.85rem;background:#222;border:1px solid #333;}
    #status-pill.online{background:#064;}
    #status-pill.away{background:#665500;}
    #status-pill.offline{background:#400;}
    .layout{display:grid;grid-template-columns:1fr;gap:14px;max-width:1200px;margin:0 auto 20px;padding:0 10px 18px;}
    @media(min-width:900px){.layout{grid-template-columns:1.1fr 1.3fr;}}
    section{background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:12px;margin:0;}
    section h2{margin:4px 0 8px;font-size:1rem;border-bottom:1px solid #222;padding-bottom:4px;}
    .meta{font-size:.78rem;color:var(--muted);margin-top:4px;line-height:1.15rem;}
    select,button,input,textarea{font-family:inherit;}
    select,button,input[type=text],input[type=url]{padding:7px 9px;border-radius:6px;border:none;margin:4px 0;font-weight:600;font-size:.85rem;}
    textarea{width:100%;min-height:90px;background:#111;color:#fff;border:1px solid var(--red);border-radius:6px;padding:8px;resize:vertical;font-size:.85rem;}
    .row{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin:6px 0;}
    .preview-box{margin-top:6px;padding:8px;border-radius:6px;border:1px dashed #444;background:#050505;font-size:.8rem;color:#ddd;line-height:1.2rem;}
    .img-box{max-width:100%;margin:8px auto 4px;border:2px solid var(--red);border-radius:6px;padding:6px;background:#000;}
    .img-box img{width:100%;border-radius:6px;}

    .grid-dispatch{display:grid;grid-template-columns:1fr;gap:8px;}
    @media(min-width:900px){.grid-dispatch{grid-template-columns:repeat(3,1fr);}}
    .column{background:#000;border-radius:8px;border:1px solid #222;overflow:hidden;}
    .col-header{padding:8px 10px;border-bottom:1px solid #222;font-weight:700;font-size:.8rem;display:flex;justify-content:space-between;align-items:center;}
    .col-body{max-height:60vh;overflow-y:auto;padding:8px;}
    .empty-text{text-align:center;color:#777;padding:18px 6px;font-size:.8rem;}
    .card{background:#111;border:1px solid #333;border-radius:8px;padding:8px;margin-bottom:8px;font-size:.78rem;}
    .card-label-row{display:flex;justify-content:space-between;margin-bottom:4px;gap:8px;}
    .badge{padding:2px 6px;border-radius:999px;font-size:.65rem;border:1px solid #666;white-space:nowrap;}
    .loc-line{margin:3px 0;font-size:.76rem;}
    .eta-line{margin-top:3px;font-size:.75rem;color:#ccc;}
    .vehicle-select-row{display:flex;align-items:center;gap:6px;margin:6px 0;}
    .vehicle-thumb{width:50px;height:50px;object-fit:cover;border-radius:6px;border:1px solid #333;}
    .vehicle-dropdown{flex:1;background:#111;color:#fff;border:1px solid #333;padding:5px;border-radius:6px;font-size:.75rem;min-width:160px;}
    .card-footer{border-top:1px solid #222;margin-top:6px;padding-top:6px;display:flex;justify-content:space-between;align-items:flex-start;gap:6px;flex-wrap:wrap;}
    .status-dropdown{background:#111;color:#fff;border:1px solid #333;padding:4px;border-radius:6px;font-size:.75rem;}
    .chip{padding:3px 7px;border-radius:999px;border:1px solid #444;background:#111;color:#eee;font-size:.7rem;cursor:pointer;text-decoration:none;display:inline-block;}
    .chip.primary{border-color:var(--red);color:#ffdada;}
    #toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#111;color:#fff;border:1px solid var(--red);padding:8px 16px;border-radius:16px;opacity:0;pointer-events:none;transition:opacity .35s;z-index:50;font-size:.8rem;max-width:92vw;text-align:center;}
    #toast.show{opacity:1;}
    #debugLog{font-family:monospace;font-size:.72rem;color:#0f0;background:#000;padding:6px;max-height:220px;overflow:auto;border-top:1px solid #222;margin:0 auto 18px;max-width:1200px;}

    /* ðŸ”€ Admin / Driver mode visibility (FIXED) */
    body.mode-driver .admin-only{display:none;}
    body.mode-admin  .admin-only{display:block;}

    body.mode-admin  .driver-only{display:none;}
    body.mode-driver .driver-only{display:block;}

    /* ===== HEADER MOBILE CLEANUP (MUST live inside <style>) ===== */
    header{flex-wrap:wrap;gap:8px;}
    .header-left{flex:1 1 260px;min-width:0;}
    .header-right{flex:1 1 260px;justify-content:flex-end;flex-wrap:wrap;gap:8px;}
    @media (max-width:520px){
      .header-left img{height:34px;}
      #livePill{padding:3px 8px;font-size:.72rem;}
      .btn{padding:8px 10px;font-size:.78rem;border-radius:10px;}
      .header-left div div:nth-child(2){display:none;}
      .header-left > div{max-width:160px;}
    }
  </style>
</head>

<body class="mode-admin">
  <!-- âœ… your body HTML here (header/layout/etc) -->

  <script>
    /* âœ… your big JS block here (endpoints, functions, init) */
  </script>
</body>
</html>