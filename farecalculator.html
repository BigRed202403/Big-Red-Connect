<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fare Calculator ‚Äì Big Red Connect</title>
  <style>
    body{background:#000;color:#fff;font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
      margin:0;padding:20px;max-width:640px;margin:auto;text-align:center}
    .logo{margin:28px 0 16px}
    h1{color:#c40000;font-size:1.9em;margin:0 0 10px}
    p.lead{color:#bbb;margin:0 0 18px}
    label{display:block;text-align:left;margin:14px 0 6px;color:#ccc}
    input,select{width:100%;padding:12px;border-radius:8px;border:1px solid #333;background:#111;color:#fff}
    .btn{background:#c40000;color:#fff;border:none;padding:12px 22px;border-radius:10px;
      margin-top:16px;font-weight:700;font-size:1.05em;box-shadow:0 3px 6px rgba(255,0,0,.3);
      cursor:pointer;transition:.15s}
    .btn:hover{background:#990000;transform:scale(1.03)}
    #result{background:#111;border:1px solid #c40000;border-radius:12px;padding:18px;margin-top:22px;text-align:left}
    #result .total{font-size:1.6em;color:#ff4444;font-weight:800;text-align:center;margin:0 0 8px}
    #map{width:100%;height:220px;border-radius:10px;margin-top:16px;border:2px solid #c40000}
    .disclaimer{font-size:.9em;color:#999;margin:16px 0 28px;font-style:italic}
    footer{margin:28px 0 36px;color:#666;font-size:.9em}
    footer a{color:#aaa;text-decoration:none}
    footer a:hover{text-decoration:underline;color:#fff}
    .routeBtn{display:block;text-align:center;margin-top:14px}
    .routeBtn a{display:inline-block;background:#c40000;color:#fff;padding:10px 18px;
      border-radius:6px;text-decoration:none;font-weight:bold;box-shadow:0 2px 6px rgba(255,0,0,.4)}
    .routeBtn a:hover{background:#990000}
  </style>
</head>
<body>
  <div class="logo">
    <img src="148D1A08-D537-4A0C-B141-2336DBF68A15.png" alt="Big Red Connect" width="260">
  </div>

  <h1>Big Red Connect Fare Calculator</h1>
  <p class="lead">
    Type an address or business (e.g. <em>Walmart</em>, <em>Campus Corner</em>, <em>Riverwind Casino</em>) ‚Äî or tap the pin to use your current location.
  </p>

  <label for="pickup">Pickup Location:</label>
  <input id="pickup" type="text" placeholder="Enter pickup address or place">

  <label for="dropoff">Drop-off Location:</label>
  <input id="dropoff" type="text" placeholder="Enter drop-off address or place">

  <div id="map"></div>

  <button id="locateBtn" class="btn">üìç Use My Location</button>

  <label for="tripType">Ride Type:</label>
  <select id="tripType">
    <option value="10">Standard ($10 base)</option>
    <option value="15">Rush Hour ($15 base)</option>
    <option value="15">Airport ($15 base)</option>
    <option value="20">Special Event ($20 base)</option>
  </select>

  <label for="travelFee">Travel Fairness Fee:</label>
  <select id="travelFee">
    <option value="0">None (within OKC Metro)</option>
    <option value="10">$10 (short trip outside metro)</option>
    <option value="20">$20 (long trip outside metro)</option>
  </select>

  <label for="payment">Payment Method:</label>
  <select id="payment">
    <option value="cash">Cash (no fees)</option>
    <option value="card">Card (+3.3% booking + 2.4% fuel)</option>
  </select>

  <button class="btn" id="calcBtn">üí≤ Calculate Fare</button>

  <div id="result" style="display:none;"></div>

  <div class="disclaimer">*Estimates only. Final fare may vary slightly based on route, wait time, or negotiated pricing.</div>

  <footer>
    &copy; 2025 Big Red Connect ‚Äî <a href="index.html">Return to Main Page</a>
  </footer>

  <script async
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBt7cqE9K9uSIdAUdE7-_KGNmKIFdvxctA&libraries=places,geometry" defer></
  </script>

  <script>
    let pickupLatLng=null,dropoffLatLng=null,map,markerA,markerB,geocoder,distanceService;
    function initGoogle(){
      geocoder=new google.maps.Geocoder();
      distanceService=new google.maps.DistanceMatrixService();
      map=new google.maps.Map(document.getElementById('map'),{
        center:{lat:35.4676,lng:-97.5164},zoom:10,mapId:"bigred_map",
        styles:[
          {elementType:"geometry",stylers:[{color:"#1a1a1a"}]},
          {elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},
          {featureType:"road",stylers:[{color:"#333333"}]},
          {featureType:"poi",stylers:[{color:"#2a2a2a"}]}
        ]
      });
      const options={fields:['geometry','name'],types:['establishment','geocode']};
      const pickupAC=new google.maps.places.Autocomplete(document.getElementById('pickup'),options);
      const dropoffAC=new google.maps.places.Autocomplete(document.getElementById('dropoff'),options);
      pickupAC.addListener('place_changed',()=>{const p=pickupAC.getPlace();if(p.geometry){pickupLatLng=p.geometry.location;map.panTo(pickupLatLng);if(!markerA)markerA=new google.maps.Marker({map,position:pickupLatLng,label:"A"});else markerA.setPosition(pickupLatLng);}});
      dropoffAC.addListener('place_changed',()=>{const p=dropoffAC.getPlace();if(p.geometry){dropoffLatLng=p.geometry.location;map.panTo(dropoffLatLng);if(!markerB)markerB=new google.maps.Marker({map,position:dropoffLatLng,label:"B"});else markerB.setPosition(dropoffLatLng);}});
      document.getElementById('locateBtn').addEventListener('click',getCurrentLocation);
      document.getElementById('calcBtn').addEventListener('click',calculateFare);
    }

    function getCurrentLocation(){
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
          pickupLatLng=new google.maps.LatLng(pos.coords.latitude,pos.coords.longitude);
          map.panTo(pickupLatLng);map.setZoom(13);
          if(!markerA)markerA=new google.maps.Marker({map,position:pickupLatLng,label:"A"});
          else markerA.setPosition(pickupLatLng);
          geocoder.geocode({location:pickupLatLng},(res,status)=>{
            if(status==='OK'&&res[0])document.getElementById('pickup').value=res[0].formatted_address;
          });
        });
      }
    }

    function calculateFare(){
      const pickup=document.getElementById('pickup').value.trim();
      const dropoff=document.getElementById('dropoff').value.trim();
      if(!pickup||!dropoff)return alert('Please enter both pickup and drop-off locations.');
      distanceService.getDistanceMatrix({origins:[pickupLatLng||pickup],destinations:[dropoffLatLng||dropoff],travelMode:'DRIVING'},handleDistanceResponse);
    }

    function handleDistanceResponse(res,status){
      if(status!=='OK')return alert('Error: '+status);
      const data=res.rows[0].elements[0];
      if(!data||data.status!=='OK')return alert('Could not calculate distance.');
      const miles=data.distance.value/1609.34;
      const base=parseFloat(document.getElementById('tripType').value);
      const travelFee=parseFloat(document.getElementById('travelFee').value);
      const payment=document.getElementById('payment').value;
      let fare=base;
      if(miles>10&&miles<=20)fare+=(miles-10)*1.25;
      else if(miles>20)fare+=(10*1.25)+((miles-20)*1.0);
      fare+=travelFee;
      if(payment==='card')fare+=fare*(0.033+0.024);
      const total=fare.toFixed(2);
      const distText=miles.toFixed(1)+' miles';
      const pickup=document.getElementById('pickup').value.trim();
      const dropoff=document.getElementById('dropoff').value.trim();
      const mapLink=`https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(pickup)}&destination=${encodeURIComponent(dropoff)}&travelmode=driving`;
      const resultDiv=document.getElementById('result');
      resultDiv.innerHTML=`
        <div class="total">$${total}</div>
        <p><strong>Distance:</strong> ${distText}</p>
        <p><strong>Ride Type:</strong> $${base.toFixed(2)} base</p>
        <p><strong>Travel Fee:</strong> $${travelFee.toFixed(2)}</p>
        <p><strong>Payment:</strong> ${payment==='card'?'Card (includes booking & fuel)':'Cash'}</p>
        <div class="routeBtn"><a href="${mapLink}" target="_blank">üìç View Route on Google Maps</a></div>`;
      resultDiv.style.display='block';
    }
  </script>
</body>
</html>
