<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fare Calculator – Big Red Connect</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>

  <div class="logo-header">
    <img src="official_logo.jpeg" alt="Big Red Connect Logo" />
  </div>

  <h1>Fare Calculator</h1>
  <p class="tagline">Plan your next ride connection — quick, simple, and local.</p>
  <div id="status-pill" class="status status--loading">Checking status…</div>

  <section class="info-section calculator">
    <label for="pickup">Pickup Location</label>
    <input id="pickup" type="text" placeholder="Enter pickup address or place">

    <div id="stopsWrap"></div>
    <button id="addStopBtn" class="btn primary" type="button">➕ Add Stop</button>

    <label for="dropoff">Drop-off Location</label>
    <input id="dropoff" type="text" placeholder="Enter drop-off address or place">

    <div class="location-buttons">
      <button id="useLocPickup" class="btn primary" type="button">📍 Use My Location for Pickup</button>
      <button id="useLocDrop" class="btn secondary" type="button">📍 Use My Location for Drop-off</button>
    </div>

    <div id="map" style="height:260px;border:2px solid #c40000;border-radius:10px;"></div>

    <label for="tripType">Ride Type</label>
    <select id="tripType">
      <option value="10">Standard ($10 base)</option>
      <option value="15">Rush Hour ($15 base)</option>
      <option value="15_airport">Airport ($15 base)</option>
      <option value="20">Special Event ($20 base)</option>
    </select>

    <label for="payment">Payment Method</label>
    <select id="payment">
      <option value="cash">Cash / Venmo / Cash App (no fees)</option>
      <option value="card">Card (+3.3% booking + 2.4% fuel)</option>
    </select>

    <button class="btn primary" id="calcBtn">💲 Calculate Fare</button>

    <div id="text-red-wrapper">
      <a href="sms:+14053784024?&body=Hey%20Big%20Red%20—%20I’d%20like%20to%20plan%20a%20ride%20connection." class="btn secondary">📲 Text RED</a>
    </div>

    <div id="result" style="display:none;"></div>
  </section>

  <footer>
    <p>&copy; 2025 Big Red Connect — <a href="index.html">Return to Home</a></p>
    <p style="font-size:0.8em;color:#777;margin-top:10px;line-height:1.4;">
      Vehicle imagery features actual Big Red Connect fleet vehicles.<br>
      Some backgrounds created with AI-assisted design tools for illustrative purposes only.<br>
      Brand names (Chevrolet® and GMC®) are property of their respective owners and used descriptively.
    </p>
  </footer>

  <script src="status.js"></script>

  <script>
  window.initGoogle = async function() {
    const mapEl = document.getElementById('map');
    const map = new google.maps.Map(mapEl, {
      center: {lat:35.4676, lng:-97.5164},
      zoom: 11,
      mapTypeControl: false,
      streetViewControl: false
    });

    const acPickup = new google.maps.places.Autocomplete(document.getElementById('pickup'));
    const acDrop = new google.maps.places.Autocomplete(document.getElementById('dropoff'));

    // Prefill from query param
    const params = new URLSearchParams(window.location.search);
    const dest = params.get('dropoff');
    if (dest) {
      const decoded = decodeURIComponent(dest);
      document.getElementById('dropoff').value = decoded;
    }

    document.getElementById('useLocPickup').onclick = () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(p => {
          const loc = {lat:p.coords.latitude, lng:p.coords.longitude};
          new google.maps.Geocoder().geocode({location:loc}, (res, stat) => {
            if (stat==="OK" && res[0]) {
              document.getElementById('pickup').value = res[0].formatted_address;
              map.setCenter(loc);
              map.setZoom(12);
            }
          });
        });
      }
    };
  };
  </script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCMM0dxLNM7XQI5G3OBSnINeO5hcS3Ks5I&libraries=places,geometry&callback=initGoogle" async defer></script>
</body>
</html>
