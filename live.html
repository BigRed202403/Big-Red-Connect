<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Live Map â€“ Big Red Connect</title>

  <!-- ðŸš« No caching -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- ðŸŽ¨ Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- âœˆï¸ Google Maps fallback (only loads if Glympse unavailable) -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCMM0dxLNM7XQI5G3OBSnINeO5hcS3Ks5I"></script>

  <style>
    #glympse-frame, #fallback-map {
      width: 100%;
      height: 500px;
      border: none;
      border-radius: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <!-- ðŸš— Header -->
  <div class="logo-header">
    <img src="official_logo.jpeg" alt="Big Red Connect Logo" />
  </div>

  <h1>Live Map</h1>
  <p class="tagline">See where Big Red Connect is rolling â€” local and surge-free.</p>

  <!-- ðŸŸ¢ Status Pill -->
  <div id="status-pill" class="status status--loading">Checking statusâ€¦</div>

  <!-- ðŸ—ºï¸ Live Map Section -->
  <section class="info-section">
    <h2>Real-Time Location</h2>
    <p>Watch the live Glympse feed below (auto-updates every few seconds). If unavailable, a fallback map will appear.</p>

    <!-- Glympse Embed -->
    <iframe 
      id="glympse-frame"
      src="https://glympse.com/!bigredconnect"
      title="Big Red Connect Live Map"
      loading="lazy"
      allowfullscreen>
    </iframe>

    <!-- Fallback Google Map -->
    <div id="fallback-map" style="display:none;"></div>
  </section>

  <!-- ðŸ¦¶ Footer -->
  <footer>
    <p>&copy; 2025 Big Red Connect â€” <a href="index.html">Return to Home</a></p>
    <p style="font-size:0.8em;color:#777;margin-top:10px;line-height:1.4;">
      Vehicle imagery features actual Big Red Connect fleet vehicles.<br>
      Some backgrounds created with AI-assisted design tools for illustrative purposes only.<br>
      Brand names (ChevroletÂ® and GMCÂ®) are property of their respective owners and used descriptively.
    </p>
  </footer>

  <!-- ðŸ”§ Status Sync -->
  <script src="status.js"></script>

  <!-- ðŸ—ºï¸ Fallback Handler -->
  <script>
  // If Glympse doesn't load properly, display a fallback Google Map.
  window.addEventListener("load", () => {
    const iframe = document.getElementById("glympse-frame");
    const fallback = document.getElementById("fallback-map");
    setTimeout(() => {
      // If the Glympse iframe failed (e.g., no network or expired link)
      if (!iframe.contentDocument || iframe.contentDocument.body.innerHTML.length === 0) {
        iframe.style.display = "none";
        fallback.style.display = "block";
        const map = new google.maps.Map(fallback, {
          center: { lat: 35.4676, lng: -97.5164 },
          zoom: 10,
          mapTypeControl: false,
          streetViewControl: false
        });
        new google.maps.Marker({
          position: { lat: 35.4676, lng: -97.5164 },
          map,
          title: "Big Red Connect (Default Coverage Area)"
        });
      }
    }, 3500);
  });
  </script>
</body>
</html>
